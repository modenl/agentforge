# AgentForge E2E Tests

ä½¿ç”¨ Playwright å®ç°çš„ç«¯åˆ°ç«¯æµ‹è¯•å¥—ä»¶ï¼Œç”¨äºæµ‹è¯• AgentForge åº”ç”¨çš„æ ¸å¿ƒåŠŸèƒ½ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
# ä»é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ
npm run test:e2e:install
```

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•ï¼ˆæ— å¤´æ¨¡å¼ï¼‰
npm run test:e2e

# è¿è¡Œæµ‹è¯•ï¼ˆæœ‰å¤´æ¨¡å¼ï¼Œå¯ä»¥çœ‹åˆ°æµè§ˆå™¨ï¼‰
npm run test:e2e:headed

# è°ƒè¯•æ¨¡å¼è¿è¡Œ
npm run test:e2e:debug

# ä½¿ç”¨ Playwright UI è¿è¡Œ
cd tests/e2e && npm run test:ui
```

## ğŸ“‹ æµ‹è¯•è¦†ç›–

### 1. åº”ç”¨å¯åŠ¨æµ‹è¯• (`app-startup.spec.ts`)
- âœ… åº”ç”¨æˆåŠŸå¯åŠ¨
- âœ… æ˜¾ç¤ºæ¬¢è¿æ¶ˆæ¯
- âœ… æ˜¾ç¤ºæ­£ç¡®çš„ Assist Card é€‰é¡¹
- âœ… å“åº”ç”¨æˆ·æ¶ˆæ¯
- âœ… ä½¿ç”¨æµ‹è¯•ç¯å¢ƒé…ç½®ï¼ˆgpt-4o-miniï¼‰

### 2. æ£‹å±€å›æ”¾æµ‹è¯• (`chess-replay.spec.ts`)
- âœ… èƒ½å¤Ÿé€‰æ‹©ç»å…¸æ£‹å±€
- âœ… åŠ è½½å¹¶æ˜¾ç¤ºæ£‹å±€å›æ”¾
- âœ… æä¾›æ£‹å±€è§£è¯´

### 3. ä¸‹æ£‹åŠŸèƒ½æµ‹è¯• (`chess-play.spec.ts`)
- âœ… å¼€å§‹æ–°æ¸¸æˆ
- âœ… ELO ç­‰çº§è®¾ç½®
- âœ… éš¾åº¦çº§åˆ«é€‰æ‹©
- âœ… èµ°æ£‹å»ºè®®å’Œå¸®åŠ©
- âœ… åˆ‡æ¢é»‘ç™½æ£‹

### 4. Assist Card äº¤äº’æµ‹è¯• (`assist-card.spec.ts`)
- âœ… æ ¹æ®ä¸Šä¸‹æ–‡æ˜¾ç¤ºåˆé€‚çš„é€‰é¡¹
- âœ… ç”¨æˆ·æ“ä½œåæ›´æ–°å¡ç‰‡
- âœ… æŒ‰é’®ç‚¹å‡»å¤„ç†
- âœ… é€‰é¡¹æ•°é‡åˆç†ï¼ˆä¸è¶…è¿‡8ä¸ªï¼‰
- âœ… æä¾›ä¸Šä¸‹æ–‡ç›¸å…³çš„å¸®åŠ©
- âœ… å¯¼èˆªåŠŸèƒ½

## ğŸ”§ æµ‹è¯•ç¯å¢ƒé…ç½®

æµ‹è¯•ä½¿ç”¨ç‹¬ç«‹çš„ç¯å¢ƒé…ç½®ï¼Œä¸ç”Ÿäº§ç¯å¢ƒéš”ç¦»ï¼š

- **AI æ¨¡å‹**: `gpt-4o-mini`ï¼ˆæ›´ä¾¿å®œçš„æµ‹è¯•æ¨¡å‹ï¼‰
- **æ•°æ®å­˜å‚¨**: `tests/e2e/test-data/`ï¼ˆç‹¬ç«‹çš„æµ‹è¯•æ•°æ®ç›®å½•ï¼‰
- **æ—¥å¿—**: `tests/e2e/test-logs/`ï¼ˆç‹¬ç«‹çš„æµ‹è¯•æ—¥å¿—ç›®å½•ï¼‰

### ç¯å¢ƒå˜é‡

åœ¨ `tests/e2e/.env.test` ä¸­é…ç½®ï¼š

```env
NODE_ENV=test
OPENAI_MODEL=gpt-4o-mini
OPENAI_API_KEY=your_test_api_key_here
TEST_DATA_DIR=./test-data
TEST_LOGS_DIR=./test-logs
DISABLE_AUTO_UPDATE=true
DISABLE_ANALYTICS=true
```

## ğŸ—ï¸ æµ‹è¯•æ¶æ„

### Page Object æ¨¡å¼

ä½¿ç”¨ Page Object æ¨¡å¼å°è£…é¡µé¢äº¤äº’é€»è¾‘ï¼š

```typescript
// pages/chess-app.page.ts
export class ChessAppPage {
  // å®šä½å™¨
  readonly chatInput: Locator;
  readonly assistCard: Locator;
  
  // äº¤äº’æ–¹æ³•
  async sendMessage(message: string) { }
  async clickAssistCardAction(actionText: string) { }
  async waitForAssistantResponse() { }
}
```

### æµ‹è¯•åŸºç¡€è®¾æ–½

```typescript
// fixtures/test-base.ts
export const test = base.extend<{
  electronApp: ElectronApplication;
  page: Page;
}>({
  // Electron åº”ç”¨å¯åŠ¨é…ç½®
  // æµ‹è¯•ç¯å¢ƒè®¾ç½®
});
```

## ğŸ“Š æµ‹è¯•æŠ¥å‘Š

æµ‹è¯•å®Œæˆåï¼Œå¯ä»¥æŸ¥çœ‹è¯¦ç»†çš„æµ‹è¯•æŠ¥å‘Šï¼š

```bash
# æŸ¥çœ‹ HTML æŠ¥å‘Š
cd tests/e2e && npm run test:report
```

æµ‹è¯•ç»“æœä¿å­˜åœ¨ï¼š
- `tests/e2e/test-results/` - æµ‹è¯•ç»“æœå’Œæˆªå›¾
- `tests/e2e/playwright-report/` - HTML æµ‹è¯•æŠ¥å‘Š

## ğŸ” è°ƒè¯•æŠ€å·§

1. **ä½¿ç”¨è°ƒè¯•æ¨¡å¼**ï¼š
   ```bash
   npm run test:e2e:debug
   ```

2. **å•ç‹¬è¿è¡ŒæŸä¸ªæµ‹è¯•**ï¼š
   ```bash
   cd tests/e2e
   npx playwright test tests/app-startup.spec.ts
   ```

3. **æŸ¥çœ‹æµ‹è¯•å½•åƒ**ï¼š
   æµ‹è¯•å¤±è´¥æ—¶ä¼šè‡ªåŠ¨å½•åˆ¶è§†é¢‘ï¼Œä¿å­˜åœ¨ `test-results/` ç›®å½•

4. **ä½¿ç”¨ Playwright Inspector**ï¼š
   è°ƒè¯•æ¨¡å¼ä¼šå¯åŠ¨ Playwright Inspectorï¼Œå¯ä»¥é€æ­¥æ‰§è¡Œæµ‹è¯•

## ğŸš§ å·²çŸ¥é™åˆ¶

1. **WebView æµ‹è¯•**: Electron ä¸­çš„ WebView æµ‹è¯•æœ‰ä¸€å®šé™åˆ¶ï¼ŒæŸäº›äº¤äº’å¯èƒ½éœ€è¦ç‰¹æ®Šå¤„ç†
2. **AI å“åº”æ—¶é—´**: å³ä½¿ä½¿ç”¨ gpt-4o-miniï¼ŒAI å“åº”ä»éœ€è¦ä¸€å®šæ—¶é—´ï¼Œæµ‹è¯•ä¸­è®¾ç½®äº†åˆç†çš„è¶…æ—¶
3. **å¹¶å‘æµ‹è¯•**: ç”±äºåº”ç”¨çš„å•ä¾‹ç‰¹æ€§ï¼Œå»ºè®®ä¸²è¡Œè¿è¡Œæµ‹è¯•

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ·»åŠ æ–°æµ‹è¯•æ—¶ï¼Œè¯·éµå¾ªä»¥ä¸‹åŸåˆ™ï¼š

1. ä½¿ç”¨ Page Object æ¨¡å¼å°è£…é¡µé¢äº¤äº’
2. æµ‹è¯•åº”è¯¥ç‹¬ç«‹ï¼Œä¸ä¾èµ–å…¶ä»–æµ‹è¯•çš„æ‰§è¡Œé¡ºåº
3. ä½¿ç”¨æè¿°æ€§çš„æµ‹è¯•åç§°
4. æ·»åŠ é€‚å½“çš„ç­‰å¾…å’Œé‡è¯•æœºåˆ¶
5. åœ¨æµ‹è¯•å¤±è´¥æ—¶æä¾›æœ‰ç”¨çš„é”™è¯¯ä¿¡æ¯

## ğŸ“ ç»´æŠ¤è¯´æ˜

- å®šæœŸæ›´æ–° Playwright ç‰ˆæœ¬ä»¥è·å¾—æœ€æ–°åŠŸèƒ½å’Œä¿®å¤
- æ ¹æ®åº”ç”¨åŠŸèƒ½å˜åŒ–æ›´æ–°æµ‹è¯•ç”¨ä¾‹
- ç›‘æ§æµ‹è¯•æ‰§è¡Œæ—¶é—´ï¼Œä¼˜åŒ–æ…¢é€Ÿæµ‹è¯•
- å®šæœŸæ¸…ç†æµ‹è¯•æ•°æ®ç›®å½•